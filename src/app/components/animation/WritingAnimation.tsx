import { useEffect, useState } from 'react';
import './animation.css';

interface AnimationProps {
  onLoad: () => void;
}

const WritingAnimation: React.FC<AnimationProps> = ({ onLoad }) => {
  const masks = [
    'w',
    'rite',
    'dot',
    't-line',
    'comma1',
    'erase',
    'comma2',
    'repeat',
    't-line2',
  ];
  const [animationEnded, setAnimationEnded] = useState(false);

  useEffect(() => {
    masks.forEach((letter) => {
      const id = `#mask-${letter}`;
      let path = document.querySelector(id) as SVGPathElement;
      console.log(id);
      if (path) {
        const length = path.getTotalLength();
        path.style.strokeDasharray = JSON.stringify(length);
        path.style.strokeDashoffset = JSON.stringify(length);
      }
    });

    const lastPath = document.querySelector('#mask-t-line2') as SVGPathElement;

    if (lastPath) {
      const animationEndHandler = () => {
        console.log(`Animation ended for #mask-t-line2`);
        setAnimationEnded(true);
      };

      lastPath.addEventListener('animationend', animationEndHandler);

      return () => {
        lastPath.removeEventListener('animationend', animationEndHandler);
      };
    }
  }, []);

  useEffect(() => {
    if (animationEnded) {
      onLoad();
    }
  }, [animationEnded]);

  return (
    <div>
      <svg
        className='animation'
        width='1247'
        height='190'
        viewBox='0 0 1247 190'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'
      >
        <defs>
          <mask id='mask-write-w'>
            <path
              className='mask'
              id='mask-w'
              d='M14.883 70.4327C14.883 91.1319 6.2957 108.759 4.05076 128.974C2.76987 140.507 -4.37661 179.842 18.6359 173.263C39.641 167.259 51.3803 145.804 59.3209 127.267C63.9709 116.412 68.6179 105.454 68.6179 93.4736C68.6179 86.2528 67.4446 77.7683 61.7092 88.0974C55.9158 98.5307 55.6975 121.277 59.0651 133.07C60.8372 139.275 60.3233 154.066 67.0827 157.647C70.5457 159.481 82.0173 151.145 83.9708 148.43C88.8145 141.7 95.0267 134.566 100.518 128.462C106.077 122.282 107 105.679 107 98.0818C107 82.7212 107 67.3606 107 52'
            />
          </mask>
          <mask id='mask-write-rite'>
            <path
              className='mask'
              id='mask-rite'
              d='M124.842 110.51C124.842 128.019 127.157 148.065 123.391 164.991C122.565 168.704 123.305 161.085 123.305 159.619C123.305 155.676 124.275 151.197 125.184 147.342C127.021 139.543 133.158 128.584 138.672 122.787C144.982 116.153 152.981 110.392 158.734 103.689C160.358 101.797 178.95 93.6091 180.077 97.5501C181.549 102.697 177.397 110.126 174.357 113.92C171.329 117.7 172.479 130.143 172.479 135.064C172.479 140.49 170.668 150.069 174.016 154.248C178.837 160.267 183.285 160.769 187.846 152.798C190.353 148.417 200.299 141.089 204.749 138.475C211.504 134.507 215.049 127.69 219.775 122.446C223.319 118.512 226.595 108.632 227.714 103.604C229.211 96.8752 235.483 90.4989 235.483 83.6527C235.483 70.0434 244.359 56.1453 232.751 45.7121C227.189 40.7128 221.653 47.7439 221.653 52.9591C221.653 57.6512 215.396 63.7044 214.055 68.3912C212.402 74.1667 212.747 83.0526 212.433 89.0241C212.02 96.8486 209.359 103.791 209.359 112.044C209.359 119.485 207.969 127.653 211.664 134.297C214.086 138.65 215.26 142.431 218.579 146.575C220.267 148.681 223.382 149.501 224.726 151.179C229.076 156.608 254.402 137.809 259.216 135.405C275.383 127.333 290.803 117.511 290.803 97.4648C290.803 91.5641 278.316 90.0705 275.095 93.2871C270.975 97.4011 266.547 103.031 266.216 108.975C265.82 116.101 263.236 121.42 266.985 128.158C270.071 133.706 274.954 135.997 278.51 140.436C281.912 144.683 293.567 143.011 298.487 142.738C308.677 142.172 315.97 133.906 320 125.856'
            />
          </mask>
          <mask id='mask-write-dot'>
            <path
              className='mask'
              id='mask-dot'
              d='M185 55C185 60.0697 182 63.6701 182 69'
            />
          </mask>
          <mask id='mask-write-t-line'>
            <path
              className='mask'
              id='mask-t-line'
              d='M184.47 87.9699C214.696 87.9699 244.236 80.2742 273.725 74.6574C283.747 72.7484 294.047 70.2703 304.283 70.2703'
              // M182 74C0810 74 1 1 1 1
            />
          </mask>
          <mask id='mask-write-comma1'>
            <path
              className='mask'
              id='mask-comma1'
              d='M336 132C333.129 135.388 332.034 139.909 329.017 143.074C326.531 145.682 324.085 150.186 322.521 153.467C318.573 161.752 317 168.856 317 178'
            />
          </mask>
          <mask id='mask-erase-erase'>
            <path
              className='mask'
              id='mask-erase'
              d='M402 140.043C411.309 140.043 422.761 139.188 429.963 132.666C436.534 126.715 446.945 125.866 453.834 119.627C459.107 114.851 463.684 102.319 459.972 95.2645C458.094 91.6939 450.013 93.5509 448.037 96.0365C446.121 98.4456 443.012 102.919 441.046 104.615C432.69 111.822 431.157 121.27 431.157 131.55C431.157 137.942 443.562 152.338 450.339 153.854C473.116 158.947 491.235 146.67 499.871 124.945C503.151 116.694 501.747 106.075 501.747 96.8086C501.747 88.7238 519.356 89.4763 526.3 89.0882C537.547 88.4594 571.325 87.5441 560.06 87.5441C554.001 87.5441 552.737 90.3509 548.551 93.7204C544.149 97.2635 536.302 106.204 533.972 111.477C530.111 120.22 527.042 132.322 539.343 132.322C552.94 132.322 560.349 129.352 565.857 116.882C567.81 112.46 569.267 107.068 569.267 102.213C569.267 99.9104 569.402 97.5624 569.267 95.2645C569.188 93.9168 566.369 90.7904 566.198 93.7204C565.594 104.059 562.508 116.774 564.749 126.918C566.492 134.813 571.809 145.05 580.776 143.045C587.943 141.443 592.712 128.805 597.657 123.83C611.528 109.873 621.677 86 644.461 86C653.757 86 652.134 103.236 652.134 110.705C652.134 118.324 643.194 134.127 636.788 138.156C630.139 142.337 617.854 154.783 611.041 143.131C603.346 129.968 616.316 131.07 623.744 126.918C631.791 122.42 645.487 128.061 654.435 126.06C665.131 123.669 676.23 120.844 686.661 118.511C694.206 116.824 702.403 108.972 705.076 101.441C709.981 87.6208 698.616 86 687.429 86C677.835 86 673.923 99.9598 673.618 107.96C673.512 110.712 672.183 121.286 674.385 123.058C677.912 125.897 682.164 130.687 684.359 134.553C689.146 142.981 704.451 140.433 711.982 137.727C720.918 134.515 726.952 128.651 735 124.602'
            />
          </mask>
          <mask id='mask-erase-comma2'>
            <path
              className='mask'
              id='mask-comma2'
              d='M750 132C749.384 137.698 742.458 146.646 739.833 152.042C737.114 157.631 733.852 163.29 732 169'
            />
          </mask>
          <mask id='mask-repeat-repeat'>
            <path
              className='mask'
              id='mask-repeat'
              d='M794 145.554C794.588 140.275 799.857 132.038 802.009 127.212C805.086 120.311 806.269 112.638 806.269 105.05C806.269 98.0715 806.486 89.655 802.009 84.077C800.558 82.2702 801.668 75.5946 801.668 82.8883C801.668 85.7131 802.785 90.463 805.587 92.0588C819.637 100.06 834.648 105.392 849.975 108.786C862.912 111.652 881.413 104.612 881.413 89.7661C881.413 68.8374 856.876 84.8659 856.876 98.9367C856.876 107.326 856.214 115.241 856.876 123.816C857.613 133.364 867.602 131.798 874.512 131.798C890.976 131.798 891.375 120.496 903.735 113.457C907.021 111.586 908.333 106.666 911.318 104.286C912.148 103.624 912.085 100.962 912.085 102.758C912.085 105.305 912.085 107.852 912.085 110.4C912.085 117.77 913.593 126.943 912 134.09C908.479 149.878 905.951 165.083 905.951 181.556C905.951 182.886 905.951 193.009 905.951 189.114C905.951 184.896 905.951 180.679 905.951 176.462C905.951 167.642 907.484 159.517 907.484 150.903C907.484 123.03 913.448 84.4167 948.124 84.4167C953.915 84.4167 961.159 88.4218 961.159 95.1156C961.159 103.345 954.618 107.973 949.742 114.221C944.004 121.574 938.879 125.748 930.488 129.93C923.958 133.183 913.336 136.383 926.654 136.383C931.453 136.383 946.377 138.999 950.083 136.043C954.12 132.825 965.756 129.645 971.212 128.656C984.296 126.285 997.612 116.023 1007.93 108.022C1014.18 103.179 1028.58 79.2341 1011.77 78.303C995.801 77.419 991.83 95.1849 991.83 107.343C991.83 116.5 994.124 119.753 999.498 126.448C1001.23 128.601 1005.31 128.741 1007.93 128.741C1010.02 128.741 1015.8 126.24 1016.71 126.873C1021.13 129.955 1034.34 117.728 1036.3 114.306C1039.63 108.511 1046.64 108.129 1051.3 103.946C1053.47 101.999 1056.09 100.526 1058.11 98.5121C1060.45 96.1873 1062.28 92.4437 1064.67 90.5304C1067.82 88.0231 1067.04 87.4735 1072.34 87.4735C1073.62 87.4735 1082.43 85.9451 1078.39 85.9451C1075.79 85.9451 1083.88 86.8258 1085.72 88.6623C1086.99 89.9328 1090.74 95.8671 1089.89 92.9079C1087.13 83.2659 1073.64 93.4356 1068.17 95.4553C1057.97 99.2184 1049.89 108.035 1044.74 117.278C1040.63 124.653 1037.66 133.326 1048.57 133.326C1057.92 133.326 1069.26 138.267 1078.39 132.477C1085.76 127.804 1086.4 122.249 1089.64 114.985C1092.07 109.526 1089.98 98.8176 1089.98 92.823C1089.98 88.8791 1089.98 97.6073 1089.98 98.9367C1089.98 102.432 1089.47 108.707 1088.1 111.928C1086.22 116.388 1084.09 134.379 1090.83 136.298C1101.34 139.291 1116.22 132.065 1123.72 125.005C1136.32 113.14 1148.7 99.5121 1157.12 84.4167C1161.18 77.1221 1161.47 68.5637 1163.59 60.6412C1166.43 50.0345 1172.14 38.8465 1172.79 27.8651C1172.95 25.142 1175.69 21.6042 1175.86 18.6946C1176.08 14.9035 1175.86 11.03 1175.86 7.23141C1175.86 -4.42066 1165.48 6.11496 1165.12 12.5809C1164.88 16.8691 1162.84 21.4338 1161.72 25.6574C1159.84 32.7138 1158.99 41.8905 1158.99 49.263C1158.99 63.132 1158.99 77.001 1158.99 90.87C1158.99 99.136 1162.21 109.172 1167.34 115.749C1173.46 123.587 1181.3 122.516 1189.66 126.024C1193.34 127.567 1217.11 131.992 1220.33 127.977C1224.86 122.341 1228 116.278 1228 108.871'
            />
          </mask>
          <mask id='mask-repeat-t-line2'>
            <path
              className='mask'
              id='mask-t-line2'
              d='M1099 74C1147.85 74 1196.22 65 1245 65'
            />
          </mask>
        </defs>
        <path
          d='M14.883 70.4327C14.883 91.1319 6.2957 108.759 4.05076 128.974C2.76987 140.507 -4.37661 179.842 18.6359 173.263C39.641 167.259 51.3803 145.804 59.3209 127.267C63.9709 116.412 68.6179 105.454 68.6179 93.4736C68.6179 86.2528 67.4446 77.7683 61.7092 88.0974C55.9158 98.5307 55.6975 121.277 59.0651 133.07C60.8372 139.275 60.3233 154.066 67.0827 157.647C70.5457 159.481 82.0173 151.145 83.9708 148.43C88.8145 141.7 95.0267 134.566 100.518 128.462C106.077 122.282 107 105.679 107 98.0818C107 82.7212 107 67.3606 107 52'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-write-w)'
        />
        <path
          d='M124.842 110.51C124.842 128.019 127.157 148.065 123.391 164.991C122.565 168.704 123.305 161.085 123.305 159.619C123.305 155.676 124.275 151.197 125.184 147.342C127.021 139.543 133.158 128.584 138.672 122.787C144.982 116.153 152.981 110.392 158.734 103.689C160.358 101.797 178.95 93.6091 180.077 97.5501C181.549 102.697 177.397 110.126 174.357 113.92C171.329 117.7 172.479 130.143 172.479 135.064C172.479 140.49 170.668 150.069 174.016 154.248C178.837 160.267 183.285 160.769 187.846 152.798C190.353 148.417 200.299 141.089 204.749 138.475C211.504 134.507 215.049 127.69 219.775 122.446C223.319 118.512 226.595 108.632 227.714 103.604C229.211 96.8752 235.483 90.4989 235.483 83.6527C235.483 70.0434 244.359 56.1453 232.751 45.7121C227.189 40.7128 221.653 47.7439 221.653 52.9591C221.653 57.6512 215.396 63.7044 214.055 68.3912C212.402 74.1667 212.747 83.0526 212.433 89.0241C212.02 96.8486 209.359 103.791 209.359 112.044C209.359 119.485 207.969 127.653 211.664 134.297C214.086 138.65 215.26 142.431 218.579 146.575C220.267 148.681 223.382 149.501 224.726 151.179C229.076 156.608 254.402 137.809 259.216 135.405C275.383 127.333 290.803 117.511 290.803 97.4648C290.803 91.5641 278.316 90.0705 275.095 93.2871C270.975 97.4011 266.547 103.031 266.216 108.975C265.82 116.101 263.236 121.42 266.985 128.158C270.071 133.706 274.954 135.997 278.51 140.436C281.912 144.683 293.567 143.011 298.487 142.738C308.677 142.172 315.97 133.906 320 125.856'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-write-rite)'
        />
        <path
          d='M185 55C185 60.0697 182 63.6701 182 69'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-write-dot)'
        />
        <path
          d='M184.47 87.9699C214.696 87.9699 244.236 80.2742 273.725 74.6574C283.747 72.7484 294.047 70.2703 304.283 70.2703'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-write-t-line)'
        />
        <path
          d='M336 132C333.129 135.388 332.034 139.909 329.017 143.074C326.531 145.682 324.085 150.186 322.521 153.467C318.573 161.752 317 168.856 317 178'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-write-comma1)'
        />
        <path
          d='M402 140.043C411.309 140.043 422.761 139.188 429.963 132.666C436.534 126.715 446.945 125.866 453.834 119.627C459.107 114.851 463.684 102.319 459.972 95.2645C458.094 91.6939 450.013 93.5509 448.037 96.0365C446.121 98.4456 443.012 102.919 441.046 104.615C432.69 111.822 431.157 121.27 431.157 131.55C431.157 137.942 443.562 152.338 450.339 153.854C473.116 158.947 491.235 146.67 499.871 124.945C503.151 116.694 501.747 106.075 501.747 96.8086C501.747 88.7238 519.356 89.4763 526.3 89.0882C537.547 88.4594 571.325 87.5441 560.06 87.5441C554.001 87.5441 552.737 90.3509 548.551 93.7204C544.149 97.2635 536.302 106.204 533.972 111.477C530.111 120.22 527.042 132.322 539.343 132.322C552.94 132.322 560.349 129.352 565.857 116.882C567.81 112.46 569.267 107.068 569.267 102.213C569.267 99.9104 569.402 97.5624 569.267 95.2645C569.188 93.9168 566.369 90.7904 566.198 93.7204C565.594 104.059 562.508 116.774 564.749 126.918C566.492 134.813 571.809 145.05 580.776 143.045C587.943 141.443 592.712 128.805 597.657 123.83C611.528 109.873 621.677 86 644.461 86C653.757 86 652.134 103.236 652.134 110.705C652.134 118.324 643.194 134.127 636.788 138.156C630.139 142.337 617.854 154.783 611.041 143.131C603.346 129.968 616.316 131.07 623.744 126.918C631.791 122.42 645.487 128.061 654.435 126.06C665.131 123.669 676.23 120.844 686.661 118.511C694.206 116.824 702.403 108.972 705.076 101.441C709.981 87.6208 698.616 86 687.429 86C677.835 86 673.923 99.9598 673.618 107.96C673.512 110.712 672.183 121.286 674.385 123.058C677.912 125.897 682.164 130.687 684.359 134.553C689.146 142.981 704.451 140.433 711.982 137.727C720.918 134.515 726.952 128.651 735 124.602'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-erase-erase)'
        />
        <path
          d='M750 132C749.384 137.698 742.458 146.646 739.833 152.042C737.114 157.631 733.852 163.29 732 169'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-erase-comma2)'
        />
        <path
          d='M794 145.554C794.588 140.275 799.857 132.038 802.009 127.212C805.086 120.311 806.269 112.638 806.269 105.05C806.269 98.0715 806.486 89.655 802.009 84.077C800.558 82.2702 801.668 75.5946 801.668 82.8883C801.668 85.7131 802.785 90.463 805.587 92.0588C819.637 100.06 834.648 105.392 849.975 108.786C862.912 111.652 881.413 104.612 881.413 89.7661C881.413 68.8374 856.876 84.8659 856.876 98.9367C856.876 107.326 856.214 115.241 856.876 123.816C857.613 133.364 867.602 131.798 874.512 131.798C890.976 131.798 891.375 120.496 903.735 113.457C907.021 111.586 908.333 106.666 911.318 104.286C912.148 103.624 912.085 100.962 912.085 102.758C912.085 105.305 912.085 107.852 912.085 110.4C912.085 117.77 913.593 126.943 912 134.09C908.479 149.878 905.951 165.083 905.951 181.556C905.951 182.886 905.951 193.009 905.951 189.114C905.951 184.896 905.951 180.679 905.951 176.462C905.951 167.642 907.484 159.517 907.484 150.903C907.484 123.03 913.448 84.4167 948.124 84.4167C953.915 84.4167 961.159 88.4218 961.159 95.1156C961.159 103.345 954.618 107.973 949.742 114.221C944.004 121.574 938.879 125.748 930.488 129.93C923.958 133.183 913.336 136.383 926.654 136.383C931.453 136.383 946.377 138.999 950.083 136.043C954.12 132.825 965.756 129.645 971.212 128.656C984.296 126.285 997.612 116.023 1007.93 108.022C1014.18 103.179 1028.58 79.2341 1011.77 78.303C995.801 77.419 991.83 95.1849 991.83 107.343C991.83 116.5 994.124 119.753 999.498 126.448C1001.23 128.601 1005.31 128.741 1007.93 128.741C1010.02 128.741 1015.8 126.24 1016.71 126.873C1021.13 129.955 1034.34 117.728 1036.3 114.306C1039.63 108.511 1046.64 108.129 1051.3 103.946C1053.47 101.999 1056.09 100.526 1058.11 98.5121C1060.45 96.1873 1062.28 92.4437 1064.67 90.5304C1067.82 88.0231 1067.04 87.4735 1072.34 87.4735C1073.62 87.4735 1082.43 85.9451 1078.39 85.9451C1075.79 85.9451 1083.88 86.8258 1085.72 88.6623C1086.99 89.9328 1090.74 95.8671 1089.89 92.9079C1087.13 83.2659 1073.64 93.4356 1068.17 95.4553C1057.97 99.2184 1049.89 108.035 1044.74 117.278C1040.63 124.653 1037.66 133.326 1048.57 133.326C1057.92 133.326 1069.26 138.267 1078.39 132.477C1085.76 127.804 1086.4 122.249 1089.64 114.985C1092.07 109.526 1089.98 98.8176 1089.98 92.823C1089.98 88.8791 1089.98 97.6073 1089.98 98.9367C1089.98 102.432 1089.47 108.707 1088.1 111.928C1086.22 116.388 1084.09 134.379 1090.83 136.298C1101.34 139.291 1116.22 132.065 1123.72 125.005C1136.32 113.14 1148.7 99.5121 1157.12 84.4167C1161.18 77.1221 1161.47 68.5637 1163.59 60.6412C1166.43 50.0345 1172.14 38.8465 1172.79 27.8651C1172.95 25.142 1175.69 21.6042 1175.86 18.6946C1176.08 14.9035 1175.86 11.03 1175.86 7.23141C1175.86 -4.42066 1165.48 6.11496 1165.12 12.5809C1164.88 16.8691 1162.84 21.4338 1161.72 25.6574C1159.84 32.7138 1158.99 41.8905 1158.99 49.263C1158.99 63.132 1158.99 77.001 1158.99 90.87C1158.99 99.136 1162.21 109.172 1167.34 115.749C1173.46 123.587 1181.3 122.516 1189.66 126.024C1193.34 127.567 1217.11 131.992 1220.33 127.977C1224.86 122.341 1228 116.278 1228 108.871'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-repeat-repeat)'
        />
        <path
          d='M1099 74C1147.85 74 1196.22 65 1245 65'
          stroke='#0000EE'
          strokeWidth='3'
          strokeLinecap='round'
          mask='url(#mask-repeat-t-line2)'
        />
      </svg>
    </div>
  );
};

export default WritingAnimation;
